function updateHTML(){const e=document.querySelectorAll("[data-restsheet-url]");for(let t,n=0;t=e[n];n++){const e=t.dataset.restsheetSearch,n=t.dataset.restsheetLimit,s=t.dataset.restsheetOffset;let r=t.dataset.restsheetUrl;if(r=r.endsWith("/")?r:r+"/","FORM"===t.tagName)return configureForm(t,r);t.style.display="none",fetchData({URL:r,search:e,limit:n,offset:s}).then(e=>{const n=[];for(let s=0;s<e.length;s++)n.push(t.innerHTML);const s=n.map((t,n)=>interpolateString(t,e[n]));t.innerHTML=s.join(""),t.style.display="initial"}).catch(e=>console.log(e))}}function fetchData({URL:e,search:t,limit:n,offset:s}){let r=[];n&&r.push(`limit=${n}`),s&&r.push(`offset=${s}`),t&&r.push(`search=${t}`);const o=`${e}${t?"search":""}?${r.join("&")}`;return new Promise((e,t)=>{fetch(o).then(e=>e.json()).then(t=>e(t)).catch(e=>t(e))})}function interpolateString(e,t){return e.replace(/{{([^{}]*)}}/g,(e,n)=>{const s=t[n];return"string"==typeof s||"number"==typeof s?s:e})}function configureForm(e,t){t=`${t}append`,e.addEventListener("submit",n=>{n.preventDefault();let s=new FormData(e);s=Array.from(s.entries()).reduce((e,t)=>({...e,[t[0]]:t[1]}),{});const r={method:"POST",mode:"cors",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify([s])};fetch(t,r).then(e=>console.log(e))})}document.addEventListener("DOMContentLoaded",updateHTML);