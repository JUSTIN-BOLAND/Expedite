function updateHTML(){const e=document.querySelectorAll("[data-restsheet-url]");for(let t,n=0;t=e[n];n++){const e=t.dataset.restsheetSearch,n=t.dataset.restsheetLimit,s=t.dataset.restsheetOffset;let o=t.dataset.restsheetUrl;if(o=o.endsWith("/")?o:o+"/","FORM"===t.tagName)return configureForm(t,o);t.style.display="none",fetchData({URL:o,search:e,limit:n,offset:s}).then(e=>{const n=[];for(let s=0;s<e.length;s++)n.push(t.innerHTML);const s=n.map((t,n)=>interpolateString(t,e[n]));t.innerHTML=s.join(""),t.style.display=""}).catch(e=>console.log(e))}}function fetchData({URL:e,search:t,limit:n,offset:s}){let o=[];n&&o.push(`limit=${n}`),s&&o.push(`offset=${s}`),t&&o.push(`search=${t}`);const r=`${e}${t?"search":""}?${o.join("&")}`;return new Promise((e,t)=>{fetch(r).then(e=>e.json()).then(t=>e(t)).catch(e=>t(e))})}function interpolateString(e,t){return e.replace(/{{([^{}]*)}}/g,(e,n)=>{const s=t[n];return"string"==typeof s||"number"==typeof s?s:e})}function configureForm(e,t){t=`${t}append`,e.addEventListener("submit",n=>{n.preventDefault();let s=new FormData(e);s=Array.from(s.entries()).reduce((e,t)=>({...e,[t[0]]:t[1]}),{});const o={method:"POST",mode:"cors",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify([s])};fetch(t,o).then(e=>new Promise(t=>e.json().then(n=>t({status:e.status,body:n})))).then(e=>{const t=new CustomEvent("ResponseReceived",{detail:e});n.target.dispatchEvent(t)}).catch(e=>console.log(e))})}document.addEventListener("DOMContentLoaded",updateHTML);