function updateHTML(){const t=document.querySelectorAll("[data-restsheet-url]");for(let e,n=0;e=t[n];n++){const t=e.dataset.restsheetSearch,n=e.dataset.restsheetLimit,s=e.dataset.restsheetOffset;let o=e.dataset.restsheetUrl;if(o=o.endsWith("/")?o:o+"/","FORM"===e.tagName)return configureForm(e,o);e.style.display="none",fetchData({URL:o,search:t,limit:n,offset:s}).then(t=>{const n=[];for(let s=0;s<t.length;s++)n.push(e.innerHTML);const s=n.map((e,n)=>interpolateString(e,t[n]));e.innerHTML=s.join(""),e.style.display=""}).catch(t=>console.log(t))}}function fetchData({URL:t,search:e,limit:n,offset:s}){let o=[];n&&o.push(`limit=${n}`),s&&o.push(`offset=${s}`),e&&o.push(`search=${e}`);const r=`${t}${e?"search":""}?${o.join("&")}`;return new Promise((t,e)=>{fetch(r).then(t=>t.json()).then(e=>t(e)).catch(t=>e(t))})}function interpolateString(t,e){return t.replace(/{{([^{}]*)}}/g,(t,n)=>{const s=e[n];return"string"==typeof s||"number"==typeof s?s:t})}function configureForm(t,e){e=`${e}append`,t.addEventListener("submit",n=>{n.preventDefault();let s=new FormData(t);s=Array.from(s.entries()).reduce((t,e)=>({...t,[e[0]]:e[1]}),{});const o={method:"POST",mode:"cors",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify([s])};fetch(e,o).then(t=>t.json()).then(t=>{const e=new CustomEvent("updated",{detail:t});n.target.dispatchEvent(e)}).catch(t=>console.log(t))})}document.addEventListener("DOMContentLoaded",updateHTML);